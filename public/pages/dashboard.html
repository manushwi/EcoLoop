<!doctype html>
<html lang="en">

<head>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>EcoLoop ‚Äî Glass Dashboard</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Link to external CSS -->
    <link rel="stylesheet" href="../css/dashboard.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width= , initial-scale=1.0">
    <title>dashboard</title>

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>
    <div class="background-glass"></div>
    <div class="container">
        <nav class="sidebar">
            <div class="logo-section">
                <div class="logo">EcoLoop</div>
                <div class="logo-subtitle">Sustainable Future</div>
            </div>
            <div class="nav-container">
                
                <a href="#leaderboard" class="nav-item">
                    <span class="nav-item-icon">üèÜ</span>
                    Leaderboard
                </a>
                <a href="#badges" class="nav-item">
                    <span class="nav-item-icon">üéñÔ∏è</span>
                    Badges
                </a>
                <a href="#history" class="nav-item">
                    <span class="nav-item-icon">üìù</span>
                    History
                </a>
            </div>
        </nav>

        <main class="main-content">
            <div class="header">
                <div class="header-left">
                    <h1>Dashboard</h1>
                    <div class="header-subtitle">Welcome back, track your eco-impact</div>
                </div>
                <div class="header-right">
                    <div class="user-info">
                        <div class="user-name" id="userName">Loading...</div>
                        <div class="user-status" id="userStatus">Loading...</div>
                    </div>
                    <button class="logout-btn" id="logoutBtn">Logout</button>
                </div>
            </div>

            <div class="content-area">
                <section id="dashboard" class="section">
                    <div class="glass-panel">
                        <h2 class="section-title">Weekly Overview</h2>

                        <div class="metrics-grid">
                            <div class="metric-card">
                                <div class="metric-value" id="totalRecycled">--</div>
                                <div class="metric-label">Total Recycled This Week</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="totalCarbonSaved">--</div>
                                <div class="metric-label">Total Carbon Saved</div>
                            </div>
                            <div class="metric-card">
                                <div class="metric-value" id="weeklyProgress">--</div>
                                <div class="metric-label">Weekly Goal Progress</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-grid">
                            <div class="chart-container">
                                <h3 style="color: #fff; margin-bottom: 20px; font-weight: 700;">Weekly Recycling Trends</h3>
                                <div class="chart-wrapper">
                                    <canvas id="weeklyTrendsChart" width="400" height="200"></canvas>
                                </div>
                            </div>

                            <div id="leaderboard" class="leaderboard-container">
                                <h3 style="color: #fff; margin-bottom: 20px; font-weight: 700;">Community Leaders</h3>
                                <div class="leaderboard" id="leaderboardList">
                                    <div class="leaderboard-item">
                                        <span class="leaderboard-rank">--</span>
                                        <span class="leaderboard-name">Loading...</span>
                                        <span class="leaderboard-score">--</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Additional Charts Section -->
                        <div class="charts-section">
                            <h3 style="color: #fff; margin: 30px 0 20px 0; font-weight: 700;">Detailed Analytics</h3>
                            
                            <div class="charts-grid">
                                <div class="chart-card">
                                    <h4 style="color: #fff; margin-bottom: 15px; font-weight: 600;">Category Distribution</h4>
                                    <div class="chart-wrapper">
                                        <canvas id="categoryChart" width="300" height="200"></canvas>
                                    </div>
                                </div>
                                
                                <div class="chart-card">
                                    <h4 style="color: #fff; margin-bottom: 15px; font-weight: 600;">Action Types</h4>
                                    <div class="chart-wrapper">
                                        <canvas id="actionChart" width="300" height="200"></canvas>
                                    </div>
                                </div>
                                
                                <div class="chart-card">
                                    <h4 style="color: #fff; margin-bottom: 15px; font-weight: 600;">Carbon Impact Over Time</h4>
                                    <div class="chart-wrapper">
                                        <canvas id="carbonChart" width="300" height="200"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>


                <section id="badges" class="section">
                    <div class="glass-panel">
                        <h2 class="section-title">Your Badges</h2>

                        <div class="badges-grid" id="badgesGrid">
                            <div class="badge-card">
                                <div class="badge-icon">üå±</div>
                                <div class="badge-title">Loading...</div>
                                <div class="badge-description">Loading...</div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="history" class="section">
                    <div class="glass-panel">
                        <h2 class="section-title">Recent Activity</h2>

                        <div class="history-container" id="historyContainer">
                            <div class="history-item">
                                <div class="history-icon">üìù</div>
                                <div class="history-details">
                                    <div class="history-title">Loading recent activity...</div>
                                    <div class="history-subtitle">Please wait while we fetch your data</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Smooth scrolling for navigation with proper header offset
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();

                // Remove active class from all items
                document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));

                // Add active class to clicked item
                item.classList.add('active');

                // Get the target section
                const targetId = item.getAttribute('href').substring(1);
                const targetSection = document.getElementById(targetId);

                if (targetSection) {
                    const headerHeight = document.querySelector('.header').offsetHeight;
                    const targetPosition = targetSection.offsetTop - headerHeight - 20;
                    
                    document.querySelector('.content-area').scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });

 dashboardBackend
        // Enhanced scroll-based active navigation
        const sections = document.querySelectorAll('.section');
        const navItems = document.querySelectorAll('.nav-item');
        const contentArea = document.querySelector('.content-area');
        const header = document.querySelector('.header');

        const observerOptions = {
            root: contentArea,
            rootMargin: `-${header.offsetHeight + 20}px 0px -60% 0px`,
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const sectionId = entry.target.id;
                    navItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('href') === `#${sectionId}`) {
                            item.classList.add('active');
                        }
                    });
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);

    <!-- Overview -->
    <section id="overview" class="panel" role="tabpanel">
      <div class="carbon-row">
        <div class="carbon-left">
          <div class="carbon-value" id="carbon-value">(wgt. of carbon saved)</div>
          <div class="carbon-sub">Your environmental contribution</div>

          <div class="progress" aria-hidden="true"><i id="carbon-fill" style="width: 0%;"></i></div>
          <div style="margin-top:8px;color:var(--muted)">Goal: (wgt. of carbon saved)  ‚Äî <strong style="color:#fff">(wgt. of carbon saved) / (wgt. of carbon goal )</strong></div>
        </div>

        <div class="carbon-right">
          <div style="font-weight:800; font-size:18px;">(carbon %)</div>
          <div style="font-size:13px;color:var(--muted); margin-top:6px;">of monthly goal</div>
        </div>
      </div>

      <div style="height:14px"></div>

      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:800">Recent Activity</div>
        <div style="color:var(--muted); font-size:13px;">Your latest circular actions</div>
      </div>

      <div class="activity-list">
        <!-- Example activities commented out, add your data here -->
      </div>
    </section>

    <!-- Challenges -->
    <section id="challenges" class="panel" role="tabpanel" style="display:none;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:800">Challenges</div>
        <div style="color:var(--muted)">Active & upcoming</div>
      </div>

      <div style="height:12px"></div>

      <div class="challenge-row">
        <!-- Add challenges here -->
      </div>
    </section>

    <!-- Badges -->
    <section id="badges" class="panel" role="tabpanel" style="display:none;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:800">Achievement Badges</div>
        <div style="color:var(--muted)">Unlock by completing actions</div>
      </div>

      <div class="badges">
        <!-- Add badges here -->
      </div>
    </section>

    <!-- History -->
    <section id="history" class="panel" role="tabpanel" style="display:none;">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <div style="font-weight:800">Action History</div>
        <div style="color:var(--muted)">Complete log of circular actions</div>
      </div>

      <!-- Add history items here -->
    </section>

  </div>

  <!-- Link to external JS -->
  <script src="../js/dashboard.js"></script>

  <!-- Logout functionality -->
  <script>
    // Check authentication status on page load
    async function checkAuthStatus() {
      try {
        const response = await fetch('/api/auth/status', {
          credentials: 'include'
 main
        });

        // Add stagger animation to cards on page load
        window.addEventListener('load', () => {
            const cards = document.querySelectorAll('.metric-card, .badge-card, .history-item');
            cards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.6s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });

        // Progress bar animation
        const progressBars = document.querySelectorAll('.progress-fill');
        const animateProgressBars = () => {
            progressBars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, 500);
            });
        };

        // Trigger progress bar animation when in view
        const progressObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    animateProgressBars();
                }
            });
        }, { threshold: 0.5 });

        progressBars.forEach(bar => {
            progressObserver.observe(bar.closest('.metric-card'));
        });

        // Add floating particle effect
        const createParticle = () => {
            const particle = document.createElement('div');
            particle.style.cssText = `
                position: fixed;
                width: 4px;
                height: 4px;
                background: rgba(74, 222, 128, 0.6);
                border-radius: 50%;
                pointer-events: none;
                z-index: 1;
                left: ${Math.random() * window.innerWidth}px;
                top: ${window.innerHeight + 10}px;
                animation: floatUp 8s linear forwards;
            `;
            
            document.body.appendChild(particle);
            
            setTimeout(() => {
                particle.remove();
            }, 8000);
        };

        // Add CSS for particle animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes floatUp {
                to {
                    transform: translateY(-${window.innerHeight + 100}px) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Create particles periodically
        setInterval(createParticle, 3000);
    </script>

    <!-- Link to external JS -->
    <script src="../js/dashboard.js"></script>

</body>

</html>